<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo Ilegal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc; /* Un azul muy claro, casi blanco */
            color: #4a5568; /* Azul grisáceo para el texto */
        }
        .container {
            max-width: 480px;
            margin: 0 auto;
            background-color: transparent;
            border-radius: 12px;
            box-shadow: none;
            padding: 1.5rem;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #e2e8f0; /* Línea divisoria azul muy clara */
        }
        .logo-container {
            display: flex;
            justify-content: center;
            width: 100%;
        }
        .logo {
            width: 150px;
            height: auto;
        }
        .nav-icon {
            font-size: 1.5rem;
            cursor: pointer;
        }
        .category-card {
            background-color: #e2e8f0; /* Azul pastel para las categorías */
            border-radius: 12px;
            overflow: hidden;
            color: #1a202c; /* Azul oscuro para el texto de las categorías */
        }
        .collapsible-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            cursor: pointer;
            border-bottom: 1px solid #cbd5e1; /* Línea divisoria más suave */
            transition: all 0.3s ease;
        }
        .collapsible-header:hover {
            background-color: #d1d9e2; /* Tono más claro al pasar el cursor */
        }
        .collapsible-header .arrow {
            transition: transform 0.3s ease-in-out;
        }
        .collapsible-header.active .arrow {
            transform: rotate(180deg);
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            padding: 0 1rem;
        }
        .product-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #cbd5e1;
        }
        .product-item:last-child {
            border-bottom: none;
        }
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border: 1px solid #cbd5e1;
            border-radius: 9999px;
            padding: 0.25rem;
        }
        .quantity-btn {
            background-color: #cbd5e1;
            border-radius: 9999px;
            width: 2rem;
            height: 2rem;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 1.25rem;
            color: #4a5568;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .quantity-btn:hover {
            background-color: #e2eaf4;
        }
        .select-flavor {
            appearance: none;
            background-color: #cbd5e1;
            color: #1a202c;
            padding: 0.75rem 0.5rem;
            border-radius: 8px;
            border: 1px solid #aebac9;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
            margin-top: 0.5rem;
        }
        .primary-btn {
            background-color: #84b6f4; /* Azul principal */
            color: #1a202c;
            font-weight: 600;
            padding: 1rem;
            border-radius: 9999px;
            width: 100%;
            transition: background-color 0.3s;
        }
        .primary-btn:hover {
            background-color: #c4dafa; /* Azul más claro al pasar el cursor */
        }
        .form-section {
            background-color: #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
            color: #1a202c;
        }
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            background-color: #f0f4f8;
            color: #1a202c;
            margin-top: 0.5rem;
        }
        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #cbd5e1;
        }
        .summary-total {
            font-weight: bold;
            font-size: 1.25rem;
            margin-top: 1rem;
        }
        .whatsapp-btn {
            background-color: #25d366;
            color: #ffffff;
            font-weight: 600;
            padding: 1rem;
            border-radius: 9999px;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            transition: background-color 0.3s;
        }
        .whatsapp-btn:hover {
            background-color: #128c7e;
        }
        .modal {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 100;
        }
    </style>
</head>
<body class="bg-[#f7fafc] font-sans p-4">
    <div class="container min-h-screen relative overflow-hidden">
        
        <!-- Header with logo and search bar -->
        <div class="header mb-6">
            <div class="logo-container">
                <!-- Se cambió el marcador de posición por el logo real -->
                <img src="image-removebg-preview.png" alt="Ilegal Licor Logo" class="logo">
            </div>
        </div>

        <p class="text-center text-sm text-gray-600 mb-6">
            Bienvenido, compañero. Aquí encontrarás la mercancía más codiciada de la ciudad, elaborada con el mayor de los secretos y un sabor que te hará olvidar que estamos en tiempos de la Prohibición. Elige tu veneno...
        </p>
        
        <!-- Menu Categories -->
        <div>
            <!-- Ilegal Puro Section -->
            <div class="category-card">
                <button class="collapsible-header" onclick="toggleSection(this)">
                    <h2 class="text-xl font-bold">Ilegal Puro</h2>
                    <span class="arrow">&#9660;</span>
                </button>
                <div class="collapsible-content">
                    <div class="p-4">
                        <div class="product-item" data-product="Ilegal Puro - 375ml" data-price="12000">
                            <span class="text-lg font-medium">375 ml</span>
                            <span class="text-lg font-bold">$12.000</span>
                            <div class="quantity-control">
                                <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                                <span class="quantity text-lg font-bold">0</span>
                                <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                            </div>
                        </div>
                        <div class="product-item" data-product="Ilegal Puro - 750ml" data-price="22000">
                            <span class="text-lg font-medium">750 ml</span>
                            <span class="text-lg font-bold">$22.000</span>
                            <div class="quantity-control">
                                <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                                <span class="quantity text-lg font-bold">0</span>
                                <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                            </div>
                        </div>
                        <div class="product-item" data-product="Ilegal Puro - 1000ml" data-price="28000">
                            <span class="text-lg font-medium">1000 ml</span>
                            <span class="text-lg font-bold">$28.000</span>
                            <div class="quantity-control">
                                <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                                <span class="quantity text-lg font-bold">0</span>
                                <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                            </div>
                        </div>
                        <div class="product-item" data-product="Ilegal Puro - 2000ml" data-price="50000">
                            <span class="text-lg font-medium">2000 ml</span>
                            <span class="text-lg font-bold">$50.000</span>
                            <div class="quantity-control">
                                <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                                <span class="quantity text-lg font-bold">0</span>
                                <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                            </div>
                        </div>
                        <button class="primary-btn mt-6" onclick="showDeliveryAndSummary()">LISTO</button>
                    </div>
                </div>
            </div>

            <!-- Ilegal Sabores Section -->
            <div class="category-card mt-4">
                <button class="collapsible-header" onclick="toggleSection(this)">
                    <h2 class="text-xl font-bold">Ilegal Sabores</h2>
                    <span class="arrow">&#9660;</span>
                </button>
                <div class="collapsible-content">
                    <div class="p-4">
                        <div class="product-item flex-col items-start" data-product="Ilegal Sabores - 375ml" data-price="15000">
                            <div class="w-full flex justify-between items-center mb-2">
                                <span class="text-lg font-medium">375 ml</span>
                                <span class="text-lg font-bold">$15.000</span>
                            </div>
                            <select class="select-flavor" required>
                                <option value="" disabled selected>Seleccione el sabor</option>
                                <option value="Café">☕ Café</option>
                                <option value="Maracuyá">🍋 Maracuyá</option>
                                <option value="Maracuyá Cremoso">💛 Maracuyá Cremoso</option>
                                <option value="Doble Simcard">💀 Doble Simcard</option>
                            </select>
                            <div class="quantity-control mt-2 w-full">
                                <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                                <span class="quantity text-lg font-bold">0</span>
                                <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                            </div>
                        </div>
                        <div class="product-item flex-col items-start" data-product="Ilegal Sabores - 750ml" data-price="25000">
                            <div class="w-full flex justify-between items-center mb-2">
                                <span class="text-lg font-medium">750 ml</span>
                                <span class="text-lg font-bold">$25.000</span>
                            </div>
                            <select class="select-flavor" required>
                                <option value="" disabled selected>Seleccione el sabor</option>
                                <option value="Café">☕ Café</option>
                                <option value="Maracuyá">🍋 Maracuyá</option>
                                <option value="Maracuyá Cremoso">💛 Maracuyá Cremoso</option>
                                <option value="Doble Simcard">💀 Doble Simcard</option>
                            </select>
                            <div class="quantity-control mt-2 w-full">
                                <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                                <span class="quantity text-lg font-bold">0</span>
                                <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                            </div>
                        </div>
                        <div class="product-item flex-col items-start" data-product="Ilegal Sabores - 1000ml" data-price="30000">
                            <div class="w-full flex justify-between items-center mb-2">
                                <span class="text-lg font-medium">1000 ml</span>
                                <span class="text-lg font-bold">$30.000</span>
                            </div>
                            <select class="select-flavor" required>
                                <option value="" disabled selected>Seleccione el sabor</option>
                                <option value="Café">☕ Café</option>
                                <option value="Maracuyá">🍋 Maracuyá</option>
                                <option value="Maracuyá Cremoso">💛 Maracuyá Cremoso</option>
                                <option value="Doble Simcard">💀 Doble Simcard</option>
                            </select>
                            <div class="quantity-control mt-2 w-full">
                                <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                                <span class="quantity text-lg font-bold">0</span>
                                <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                            </div>
                        </div>
                        <div class="product-item flex-col items-start" data-product="Ilegal Sabores - 2000ml" data-price="55000">
                            <div class="w-full flex justify-between items-center mb-2">
                                <span class="text-lg font-medium">2000 ml</span>
                                <span class="text-lg font-bold">$55.000</span>
                            </div>
                            <select class="select-flavor" required>
                                <option value="" disabled selected>Seleccione el sabor</option>
                                <option value="Café">☕ Café</option>
                                <option value="Maracuyá">🍋 Maracuyá</option>
                                <option value="Maracuyá Cremoso">💛 Maracuyá Cremoso</option>
                                <option value="Doble Simcard">💀 Doble Simcard</option>
                            </select>
                            <div class="quantity-control mt-2 w-full">
                                <button class="quantity-btn" onclick="updateQuantity(this, -1)">-</button>
                                <span class="quantity text-lg font-bold">0</span>
                                <button class="quantity-btn" onclick="updateQuantity(this, 1)">+</button>
                            </div>
                        </div>
                        <button class="primary-btn mt-6" onclick="showDeliveryAndSummary()">LISTO</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Order Summary Section (initially hidden) -->
        <div id="orderSummary" class="hidden form-section">
            <h3 class="text-xl font-bold mb-4">Resumen del Pedido</h3>
            <div id="summaryTable"></div>
            <p class="summary-total text-right" id="totalCost">Total: $0</p>
        </div>

        <!-- Delivery Form Section (initially hidden) -->
        <div id="deliveryForm" class="hidden form-section">
            <h3 class="text-xl font-bold mb-4">Datos de Envío</h3>
            <div class="flex flex-col gap-4">
                <input type="text" id="delivery_address" placeholder="Dirección completa" class="form-input" required>
                <input type="text" id="delivery_city" placeholder="Ciudad" class="form-input" required>
                <input type="text" id="delivery_neighborhood" placeholder="Barrio" class="form-input" required>
                <button class="primary-btn" onclick="openModal()">CONFIRMAR Y PEDIR</button>
            </div>
        </div>

        <!-- The Modal -->
        <div id="orderModal" class="modal fixed inset-0 flex items-center justify-center hidden">
            <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm mx-auto text-center">
                <h3 class="font-bold text-xl mb-4">Revisa tu Pedido</h3>
                <!-- Order summary will be dynamically inserted here -->
                <div id="modalSummaryContainer" class="p-4 rounded-lg bg-gray-100 mb-6"></div>
                <p id="modalMessage" class="text-gray-700 mb-6"></p>
                <a id="whatsappLink" href="#" target="_blank" class="whatsapp-btn mb-4 hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12.04 2.1c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2.1 21.9l5.05-1.32c1.45.79 3.08 1.25 4.89 1.25 5.45 0 9.91-4.46 9.91-9.91s-4.46-9.91-9.91-9.91zm0 1.62c4.56 0 8.29 3.73 8.29 8.29s-3.73 8.29-8.29 8.29c-1.54 0-3-.42-4.24-1.16l-.3-.18-3.14.82.84-3.04-.2-.31c-.78-1.29-1.23-2.79-1.23-4.38 0-4.56 3.73-8.29 8.29-8.29zm-3.3 4.29c-.21 0-.43.08-.59.24-.16.16-.62.62-.62 1.51 0 .89.64 1.74.73 1.86.09.12 1.26 2.02 3.06 2.76 1.34.55 2.16.88 2.42.94.3.06 1.15.42 1.4.32.25-.09.62-.75.62-1.12s-.3-.62-.43-.75c-.13-.13-.3-.21-.62-.39-.32-.18-.89-.44-1.24-.62-.35-.18-.3-.24-.2-.51.09-.27.79-.83 1.11-1.2.32-.37.42-.56.56-.75.14-.19.07-.35-.02-.49-.09-.14-.79-1.93-1.08-2.61-.29-.68-.58-.59-.75-.59-.16 0-.35-.09-.54-.09z" />
                    </svg>
                    Enviar por WhatsApp
                </a>
                <button onclick="closeModal()" class="w-full px-4 py-2 bg-gray-200 rounded-full font-semibold">Cerrar</button>
            </div>
        </div>

    </div>

    <script>
        const phone = '+573108799353';

        function toggleSection(headerButton) {
            const content = headerButton.nextElementSibling;
            const arrow = headerButton.querySelector('.arrow');
            
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
                arrow.style.transform = 'rotate(0deg)';
                headerButton.classList.remove('active');
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
                arrow.style.transform = 'rotate(180deg)';
                headerButton.classList.add('active');
            }
        }

        function updateQuantity(button, delta) {
            const quantitySpan = button.parentElement.querySelector('.quantity');
            let currentQuantity = parseInt(quantitySpan.textContent);
            currentQuantity += delta;
            
            if (currentQuantity >= 0) {
                quantitySpan.textContent = currentQuantity;
            }
        }
        
        function showDeliveryAndSummary() {
            const deliveryForm = document.getElementById('deliveryForm');
            const orderSummary = document.getElementById('orderSummary');

            displayOrderSummary(); // First, update the summary with selected items

            // Then, check if there are any items selected before showing the form
            const productItems = document.querySelectorAll('[data-product]');
            let hasItems = false;
            productItems.forEach(item => {
                const quantity = parseInt(item.querySelector('.quantity').textContent);
                if (quantity > 0) {
                    hasItems = true;
                }
            });

            if (hasItems) {
                deliveryForm.classList.remove('hidden');
                orderSummary.classList.remove('hidden');
            } else {
                // If no items are selected, show a message
                openModalWithMessage('No has seleccionado ningún producto. Por favor, agrega al menos uno a tu pedido.');
            }
        }

        function displayOrderSummary() {
            const productItems = document.querySelectorAll('[data-product]');
            const summaryTable = document.getElementById('summaryTable');
            const totalCostEl = document.getElementById('totalCost');
            
            let summaryContent = '';
            let totalCost = 0;

            productItems.forEach(item => {
                const quantity = parseInt(item.querySelector('.quantity').textContent);
                if (quantity > 0) {
                    const product = item.getAttribute('data-product');
                    const price = parseInt(item.getAttribute('data-price'));
                    const itemTotal = quantity * price;

                    let productName = product;
                    const flavorSelect = item.querySelector('.select-flavor');
                    if (flavorSelect) {
                        productName += ` (${flavorSelect.value})`;
                    }

                    totalCost += itemTotal;

                    summaryContent += `
                        <div class="summary-item">
                            <span class="text-sm">${productName}</span>
                            <span class="text-sm">x${quantity}</span>
                            <span class="text-sm font-semibold">$${itemTotal.toLocaleString('es-CO')}</span>
                        </div>
                    `;
                }
            });

            summaryTable.innerHTML = summaryContent;
            totalCostEl.textContent = `Total: $${totalCost.toLocaleString('es-CO')}`;
        }
        
        function openModal() {
            const productItems = document.querySelectorAll('[data-product]');
            let orderSummaryText = '';
            let totalCost = 0;
            let hasItems = false;
            const address = document.getElementById('delivery_address').value;
            const city = document.getElementById('delivery_city').value;
            const neighborhood = document.getElementById('delivery_neighborhood').value;
            
            // Check if delivery data is complete
            if (!address || !city || !neighborhood) {
                openModalWithMessage('Por favor, completa todos los campos de envío.');
                return;
            }

            // Collect product information and generate HTML for modal
            let summaryHtml = '';
            productItems.forEach(item => {
                const quantity = parseInt(item.querySelector('.quantity').textContent);
                if (quantity > 0) {
                    const product = item.getAttribute('data-product');
                    const price = parseInt(item.getAttribute('data-price'));
                    
                    let flavor = '';
                    const flavorSelect = item.querySelector('.select-flavor');
                    if (flavorSelect && flavorSelect.value !== '') {
                        flavor = ` (${flavorSelect.value})`;
                    }

                    const itemTotal = quantity * price;
                    totalCost += itemTotal;

                    orderSummaryText += `* ${product}${flavor}: ${quantity} uni. ($${itemTotal.toLocaleString('es-CO')})\n`;
                    summaryHtml += `
                        <div class="summary-item">
                            <span class="text-sm">${product}${flavor}</span>
                            <span class="text-sm">x${quantity}</span>
                            <span class="text-sm font-semibold">$${itemTotal.toLocaleString('es-CO')}</span>
                        </div>
                    `;
                    hasItems = true;
                }
            });
            
            if (!hasItems) {
                openModalWithMessage('No has seleccionado ningún producto. Por favor, agrega al menos uno a tu pedido.');
                return;
            }

            let deliveryText = `\n\n*Datos de Envío:*\nDirección: ${address}\nCiudad: ${city}\nBarrio: ${neighborhood}`;
            let message = `¡Hola! Me gustaría hacer un pedido:\n\n*Resumen de tu pedido:*\n${orderSummaryText}${deliveryText}\n*Total:* $${totalCost.toLocaleString('es-CO')}\n\nGracias.`;
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${phone}?text=${encodedMessage}`;

            // Insert the summary HTML and total cost into the modal
            const modalSummaryContainer = document.getElementById('modalSummaryContainer');
            modalSummaryContainer.innerHTML = `
                ${summaryHtml}
                <div class="summary-total text-right mt-4">Total: $${totalCost.toLocaleString('es-CO')}</div>
            `;

            document.getElementById('modalMessage').textContent = "Por favor, revisa tu pedido y haz clic en el botón de WhatsApp para enviarlo.";
            document.getElementById('whatsappLink').href = whatsappUrl;
            document.getElementById('whatsappLink').classList.remove('hidden');
            document.getElementById('orderModal').classList.remove('hidden');
        }

        function openModalWithMessage(message) {
            document.getElementById('modalSummaryContainer').innerHTML = ''; // Clear summary
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('whatsappLink').classList.add('hidden');
            document.getElementById('orderModal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('orderModal').classList.add('hidden');
        }

        window.onclick = function(event) {
            const modal = document.getElementById('orderModal');
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
